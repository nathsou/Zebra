
or a b = if a then True else b;

isPrime n =
    if n == 2 then True
    else if or (n < 2) (n % 2 == 0) then False
    else let rec aux n i =
        if i * i >= n then True
        else if n % i == 0 then False
        else aux n (i + 2)
    in aux n 3;

main = isPrime 1789;
